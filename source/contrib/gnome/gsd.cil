(roleattribute is_gsd_role)

(typeattribute is_gsd_subject)
(typeattribute is_gsd_printer_subject)

;/usr/libexec/gnome-settings-daemon-localeexec
;/usr/libexec/gsd-backlight-helper
;/usr/libexec/gsd-locate-pointer
;/usr/libexec/gsd-wacom-led-helper
;/usr/libexec/gsd-wacom-oled-helper

(type gsd_exec_t)
(call application_subject_entry (is_gsd_subject gsd_exec_t))

(context file_gsd_exec (system_u object_r gsd_exec_t ((s0)(s0))))
(filecon "/usr/libexec/gnome-settings-daemon" file file_gsd_exec)

(type gsdprinter_exec_t)
(call application_subject_entry (is_gsd_printer_subject gsdprinter_exec_t))

(context file_gsdprinter_exec (system_u object_r gsdprinter_exec_t ((s0)(s0))))
(filecon "/usr/libexec/gsd-printer" file file_gsdprinter_exec)

(macro gsd_exec_gsd ((type ARG1))
    (call can_exec (ARG1 gsd_exec_t)))

(macro gsd_exec_gsdprinter ((type ARG1))
    (call can_exec (ARG1 gsdprinter_exec_t)))

(macro gsd_role_template_gsd ((role ARG1)(type ARG2)(type ARG3))
    (roleattributeset is_gsd_role ARG1)
    (typeattributeset is_gsd_subject ARG3)
    (roletype ARG1 ARG3)
    (call subtrans_pattern (ARG2 gsd_exec_t ARG3)))

(macro gsd_role_template_printer ((role ARG1)(type ARG2)(type ARG3))
    (roleattributeset is_gsd_role ARG1)
    (typeattributeset is_gsd_printer_subject ARG3)
    (roletype ARG1 ARG3)
    (call subtrans_pattern (ARG2 gsdprinter_exec_t ARG3)))
